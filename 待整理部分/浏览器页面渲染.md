参考文档：https://www.infoq.cn/article/DltDuLToZIk_ZRqfb4jG

## 浏览器渲染的过程
1. 浏览器解析HTML文件，构建DOM
  * 读取原始字节
  * 字节转换为token，并行消耗token，生成节点对象构建DOM

2. 解析过程中遇到javascript代码。因为javascript可能需要操作DOM和保证脚本的下载顺序，所以规定遇到javascript代码会阻塞其他资源下载和DOM渲染。又因为javascript代码也能操作样式，所以需要拿到完整的CSSDOM。所以浏览器会先下载和构建 CSSOM，直到javascript代码下载，解析，执行完毕，最后再从中断的地方继续构建DOM

3. 解析完成后，浏览器引擎会通过 DOM Tree 和 CSS Rule Tree 来构造 Rendering Tree
  
> CSS 匹配 HTML 元素是一个相当复杂和有性能问题的事情。所以，DOM 树要小，CSS 尽量用 id 和 class，千万不要过渡层叠下去

4. 最后通过调用操作系统 Native GUI 的 API 进行布局绘制。

补充：脚本的渲染规则
1. `<script src="script.js"></script>`
浏览器立即加载并执行指定的脚本
2. `<script async src="script.js"></script>`
异步下载。无论此刻是 HTML 解析阶段还是 DOMContentLoaded 触发之后，已经加载好，就会开始执行。即async-script 可能在 DOMContentLoaded 触发之前或之后执行，但一定在 load 触发之前执行
3. `<script defer src="script.js"></script>`
载入 JavaScript 文件时不阻塞 HTML 的解析，执行阶段被放到 HTML 标签解析完成之后。



## 重绘与回流
DOM 树的结构变化以及几何属性的变化会导致页面重新渲染，这就是所谓的回流；

而外观背景色等的操作不会引发布局变化导致重新渲染，这就是重绘。在前端开发中应当尽力避免回流来优化性能。

详细参考重绘与回流

